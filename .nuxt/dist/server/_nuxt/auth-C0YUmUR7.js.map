{"version":3,"file":"auth-C0YUmUR7.js","sources":["../../../../middleware/auth.js"],"sourcesContent":["import { useAuthStore } from '~/stores/auth'\r\n\r\nexport default defineNuxtRouteMiddleware((to, from) => {\r\n  // Skip middleware on server-side rendering\r\n  if (process.server) return\r\n\r\n  const authStore = useAuthStore()\r\n  \r\n  // Initialize auth if not already done\r\n  if (!authStore.isLoggedIn) {\r\n    authStore.initializeAuth()\r\n  }\r\n\r\n  // Check if user is authenticated\r\n  if (!authStore.isLoggedIn) {\r\n    // Redirect to login with return URL\r\n    return navigateTo({\r\n      path: '/login',\r\n      query: { redirect: to.fullPath }\r\n    })\r\n  }\r\n\r\n  // Check if session is still valid\r\n  if (!authStore.isSessionValid) {\r\n    // Try to refresh token\r\n    authStore.refreshAuthToken().catch(() => {\r\n      return navigateTo({\r\n        path: '/login',\r\n        query: { redirect: to.fullPath, message: 'Session expired. Please log in again.' }\r\n      })\r\n    })\r\n  }\r\n})\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAEA,MAAA,OAAe,0BAA0B,CAAC,IAAI,SAAS;AAEjC;AA4BtB,CAAC;"}