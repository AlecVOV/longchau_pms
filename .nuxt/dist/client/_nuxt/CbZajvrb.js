import{r as u,j as M,a as o,o as i,b as a,d as p,m as l,h as G,t as w,R as O,F as $,g as S,n as z,y as k,f as V,v as F}from"./4Al0cLfe.js";import{u as H}from"./-W0ciY3d.js";import{_ as J}from"./DlAUqK2U.js";const W={class:"image-uploader"},q={key:0,class:"space-y-2"},K={class:"text-xs text-gray-500"},Q={key:1,class:"space-y-3"},X={class:"text-sm text-gray-600"},Y={class:"w-full bg-gray-200 rounded-full h-2"},Z={key:2,class:"grid grid-cols-2 md:grid-cols-4 gap-4"},_=["src","alt","onError"],ee={class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center space-x-2"},te=["onClick","title"],ae=["onClick"],re={key:0,class:"absolute top-1 left-1"},le=["accept","disabled"],se={key:0,class:"mt-3 space-y-1"},oe={key:1,class:"mt-4 p-4 border rounded-lg bg-gray-50"},ie={class:"space-y-3"},ne={__name:"ImageUploader",props:{modelValue:{type:Array,default:()=>[]},maxImages:{type:Number,default:10},maxSizeMB:{type:Number,default:5},acceptedTypes:{type:String,default:"image/jpeg,image/jpg,image/png,image/gif,image/webp"},disabled:{type:Boolean,default:!1},showImageDetails:{type:Boolean,default:!1}},emits:["update:modelValue","upload-complete","upload-error"],setup(n,{emit:L}){const m=n,h=L,I=H(),s=u([...m.modelValue]),C=u(!1),g=u(!1),v=u(0),b=u(0),x=u(0),c=u([]),y=u(null);M(()=>m.modelValue,t=>{s.value=[...t]},{deep:!0}),M(s,t=>{h("update:modelValue",t)},{deep:!0});const j=t=>{if(t.preventDefault(),C.value=!1,m.disabled)return;const e=Array.from(t.dataTransfer.files);D(e)},T=t=>{t.currentTarget.contains(t.relatedTarget)||(C.value=!1)},U=t=>{const e=Array.from(t.target.files);D(e),t.target.value=""},D=async t=>{c.value=[];const e=t.filter(r=>r.type.startsWith("image/")?r.size>m.maxSizeMB*1024*1024?(c.value.push(`${r.name} is too large (max ${m.maxSizeMB}MB)`),!1):!0:(c.value.push(`${r.name} is not a valid image file`),!1));if(s.value.length+e.length>m.maxImages){c.value.push(`Cannot upload more than ${m.maxImages} images`);return}if(e.length!==0){g.value=!0,v.value=0,b.value=e.length,x.value=0;try{for(const r of e)await A(r),v.value++,x.value=v.value/b.value*100;I.success(`Successfully uploaded ${e.length} image(s)`),h("upload-complete",s.value)}catch(r){console.error("Upload error:",r),I.error("Failed to upload some images"),h("upload-error",r)}finally{g.value=!1,v.value=0,b.value=0,x.value=0}}},A=async t=>new Promise((e,r)=>{const d=new FileReader;d.onload=f=>{const P={id:Date.now()+Math.random(),file:t,preview:f.target.result,url:f.target.result,alt:"",caption:"",isPrimary:s.value.length===0,size:t.size,type:t.type,name:t.name};s.value.push(P),e(P)},d.onerror=r,d.readAsDataURL(t)}),N=t=>{const e=s.value[t];s.value.splice(t,1),e.isPrimary&&s.value.length>0&&(s.value[0].isPrimary=!0)},E=t=>{s.value.forEach(e=>e.isPrimary=!1),s.value[t].isPrimary=!0},R=t=>{console.error("Image failed to load:",t),I.error(`Failed to load image: ${t.name}`)},B=()=>{h("update:modelValue",s.value)};return(t,e)=>(i(),o("div",W,[a("div",{onDrop:j,onDragover:e[1]||(e[1]=k(()=>{},["prevent"])),onDragenter:e[2]||(e[2]=k(()=>{},["prevent"])),onDragleave:T,class:z(["border-2 border-dashed rounded-lg p-6 text-center transition-colors",l(C)?"border-primary-500 bg-primary-50":"border-gray-300",n.disabled?"opacity-50 cursor-not-allowed":"cursor-pointer hover:border-primary-400"]),onClick:e[3]||(e[3]=r=>!n.disabled&&t.$refs.fileInput.click())},[!l(g)&&!l(s).length?(i(),o("div",q,[e[7]||(e[7]=a("svg",{class:"mx-auto w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),a("div",null,[e[6]||(e[6]=a("p",{class:"text-sm text-gray-600"},[a("span",{class:"font-medium text-primary-600"},"Click to upload"),G(" or drag and drop ")],-1)),a("p",K,"PNG, JPG, GIF up to "+w(n.maxSizeMB)+"MB each",1)])])):p("",!0),l(g)?(i(),o("div",Q,[e[8]||(e[8]=a("div",{class:"animate-spin w-8 h-8 border-2 border-primary-600 border-t-transparent rounded-full mx-auto"},null,-1)),a("p",X,"Uploading "+w(l(v))+" of "+w(l(b))+" images...",1),a("div",Y,[a("div",{class:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:O({width:l(x)+"%"})},null,4)])])):p("",!0),l(s).length&&!l(g)?(i(),o("div",Z,[(i(!0),o($,null,S(l(s),(r,d)=>(i(),o("div",{key:r.id||d,class:"relative group"},[a("img",{src:r.preview||r.url,alt:r.alt||`Image ${d+1}`,class:"w-full h-24 object-cover rounded-lg",onError:f=>R(r)},null,40,_),a("div",ee,[a("button",{onClick:k(f=>E(d),["stop"]),class:z(["p-1 rounded text-xs",r.isPrimary?"bg-yellow-500 text-white":"bg-white text-gray-700 hover:bg-gray-100"]),title:r.isPrimary?"Primary image":"Set as primary"},e[9]||(e[9]=[a("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1)]),10,te),a("button",{onClick:k(f=>N(d),["stop"]),class:"p-1 bg-red-500 text-white rounded hover:bg-red-600",title:"Remove image"},e[10]||(e[10]=[a("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,ae)]),r.isPrimary?(i(),o("div",re,e[11]||(e[11]=[a("span",{class:"bg-yellow-500 text-white text-xs px-1 py-0.5 rounded"},"Primary",-1)]))):p("",!0)]))),128)),l(s).length<n.maxImages?(i(),o("div",{key:0,onClick:e[0]||(e[0]=r=>t.$refs.fileInput.click()),class:"w-full h-24 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center cursor-pointer hover:border-primary-400 hover:bg-gray-50 transition-colors"},e[12]||(e[12]=[a("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]))):p("",!0)])):p("",!0)],34),a("input",{ref:"fileInput",type:"file",multiple:"",accept:n.acceptedTypes,onChange:U,class:"hidden",disabled:n.disabled},null,40,le),l(c).length?(i(),o("div",se,[(i(!0),o($,null,S(l(c),r=>(i(),o("p",{key:r,class:"text-sm text-red-600"},w(r),1))),128))])):p("",!0),n.showImageDetails&&l(y)?(i(),o("div",oe,[e[15]||(e[15]=a("h4",{class:"font-medium mb-3"},"Image Details",-1)),a("div",ie,[a("div",null,[e[13]||(e[13]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Alt Text",-1)),V(a("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>l(y).alt=r),type:"text",class:"input",placeholder:"Describe this image for accessibility",onInput:B},null,544),[[F,l(y).alt]])]),a("div",null,[e[14]||(e[14]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Caption",-1)),V(a("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>l(y).caption=r),type:"text",class:"input",placeholder:"Optional image caption",onInput:B},null,544),[[F,l(y).caption]])])])])):p("",!0)]))}},pe=J(ne,[["__scopeId","data-v-3873cc1d"]]);export{pe as default};
