import{u as F,B as A,r as l,c as k,x as U,a as n,b as s,e as _,w as P,y as $,d as w,m as t,t as c,f as V,z,n as C,F as D,g as I,h as M,_ as H,o as a}from"./4Al0cLfe.js";import{_ as O}from"./DlAUqK2U.js";const Y={class:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"},Z={class:"max-w-md w-full space-y-8"},G={class:"text-center"},W={class:"bg-white p-8 rounded-lg shadow-lg"},J={key:0,class:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded"},K={key:1,class:"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded"},Q={key:2,class:"text-center space-y-4"},X={key:3,class:"space-y-4"},ee={class:"mt-1 relative"},se=["type"],te={key:0,class:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},oe={key:1,class:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},re={class:"mt-2"},ne={class:"flex space-x-1"},ae={class:"mt-1 text-xs text-gray-600"},le={key:0,class:"mt-1 text-sm text-red-600"},de=["type"],ie={key:0,class:"mt-1 text-sm text-red-600"},ue=["disabled"],pe={key:0,class:"absolute left-0 inset-y-0 flex items-center pl-3"},ce={key:4,class:"text-center space-y-4"},we={__name:"reset-password",setup(me){F({title:"Reset Password - Long Châu",meta:[{name:"description",content:"Reset your Long Châu account password. Enter your new password to regain access to your account."}]});const B=A(),v=B.query.token,y=B.query.email,r=l({password:"",confirmPassword:""}),m=l(!1),N=l(!1),p=l(!1),f=l(""),g=l(""),d=l(""),i=l(""),x=l(!1),S=l(!1),j=k(()=>{const o=r.value.password;let e=0;return o.length>=8&&e++,/[a-z]/.test(o)&&/[A-Z]/.test(o)&&e++,/\d/.test(o)&&e++,/[!@#$%^&*(),.?":{}|<>]/.test(o)&&e++,e}),E=k(()=>{const o=j.value;return o===0?"Very weak":o===1?"Weak":o===2?"Fair":o===3?"Good":"Strong"}),R=o=>{const e=j.value;return o<=e?e<=1?"bg-red-500":e===2?"bg-yellow-500":e===3?"bg-blue-500":"bg-green-500":"bg-gray-200"},T=k(()=>r.value.password&&r.value.confirmPassword&&!d.value&&!i.value),L=()=>{const o=r.value.password;o.length<8?d.value="Password must be at least 8 characters long":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(o)?d.value="":d.value="Password must contain at least one uppercase letter, one lowercase letter, and one number",r.value.confirmPassword&&b()},b=()=>{r.value.password!==r.value.confirmPassword?i.value="Passwords do not match":i.value=""},q=async()=>{var o;if(f.value="",g.value="",p.value=!0,L(),b(),d.value||i.value){p.value=!1;return}try{const e=await $fetch("/api/auth/reset-password",{method:"POST",body:{token:v,email:y,password:r.value.password,confirmPassword:r.value.confirmPassword}});g.value="Password has been reset successfully!",S.value=!0}catch(e){e.status===400||e.status===404?x.value=!0:f.value=((o=e.data)==null?void 0:o.message)||"Failed to reset password. Please try again."}finally{p.value=!1}};return U(async()=>{if(!v||!y){x.value=!0;return}try{await $fetch("/api/auth/validate-reset-token",{method:"POST",body:{token:v,email:y}})}catch{x.value=!0}}),(o,e)=>{const h=H;return a(),n("div",Y,[s("div",Z,[s("div",G,[_(h,{to:"/",class:"inline-block"},{default:P(()=>e[3]||(e[3]=[s("h1",{class:"text-3xl font-bold text-purple-600"},"Long Châu",-1)])),_:1,__:[3]}),e[4]||(e[4]=s("h2",{class:"mt-6 text-3xl font-extrabold text-gray-900"}," Set new password ",-1)),e[5]||(e[5]=s("p",{class:"mt-2 text-sm text-gray-600"}," Enter your new password below. ",-1))]),s("form",{onSubmit:$(q,["prevent"]),class:"mt-8 space-y-6"},[s("div",W,[t(f)?(a(),n("div",J,c(t(f)),1)):w("",!0),t(g)?(a(),n("div",K,c(t(g)),1)):w("",!0),t(x)?(a(),n("div",Q,[e[9]||(e[9]=s("div",{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},[s("svg",{class:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),s("div",null,[e[7]||(e[7]=s("h3",{class:"text-lg font-medium text-gray-900"},"Invalid or expired link",-1)),e[8]||(e[8]=s("p",{class:"mt-2 text-sm text-gray-600"}," This password reset link is invalid or has expired. ",-1)),_(h,{to:"/forgot-password",class:"mt-4 inline-block text-purple-600 hover:text-purple-500 text-sm font-medium"},{default:P(()=>e[6]||(e[6]=[M(" Request a new reset link ")])),_:1,__:[6]})])])):t(S)?(a(),n("div",ce,[e[18]||(e[18]=s("div",{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100"},[s("svg",{class:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),s("div",null,[e[16]||(e[16]=s("h3",{class:"text-lg font-medium text-gray-900"},"Password updated successfully",-1)),e[17]||(e[17]=s("p",{class:"mt-2 text-sm text-gray-600"}," Your password has been updated. You can now sign in with your new password. ",-1)),_(h,{to:"/login",class:"mt-4 inline-block bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 text-sm font-medium"},{default:P(()=>e[15]||(e[15]=[M(" Sign in now ")])),_:1,__:[15]})])])):(a(),n("div",X,[s("div",null,[e[12]||(e[12]=s("label",{for:"password",class:"block text-sm font-medium text-gray-700"}," New Password ",-1)),s("div",ee,[V(s("input",{id:"password","onUpdate:modelValue":e[0]||(e[0]=u=>t(r).password=u),type:t(m)?"text":"password",required:"",class:C(["block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-purple-500 focus:border-purple-500",{"border-red-500":t(d)}]),placeholder:"Enter new password",onInput:L},null,42,se),[[z,t(r).password]]),s("button",{type:"button",onClick:e[1]||(e[1]=u=>m.value=!t(m)),class:"absolute inset-y-0 right-0 pr-3 flex items-center"},[t(m)?(a(),n("svg",oe,e[11]||(e[11]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L12 12m-3.122-3.122l4.243 4.243M15 12a3 3 0 00-3-3m0 0a3 3 0 00-3 3"},null,-1)]))):(a(),n("svg",te,e[10]||(e[10]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])))])]),s("div",re,[s("div",ne,[(a(),n(D,null,I(4,u=>s("div",{key:u,class:C(["h-1 w-1/4 rounded",R(u)])},null,2)),64))]),s("p",ae," Password strength: "+c(t(E)),1)]),t(d)?(a(),n("p",le,c(t(d)),1)):w("",!0)]),s("div",null,[e[13]||(e[13]=s("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700"}," Confirm New Password ",-1)),V(s("input",{id:"confirmPassword","onUpdate:modelValue":e[2]||(e[2]=u=>t(r).confirmPassword=u),type:t(N)?"text":"password",required:"",class:C(["mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-purple-500 focus:border-purple-500",{"border-red-500":t(i)}]),placeholder:"Confirm new password",onBlur:b},null,42,de),[[z,t(r).confirmPassword]]),t(i)?(a(),n("p",ie,c(t(i)),1)):w("",!0)]),s("div",null,[s("button",{type:"submit",disabled:t(p)||!t(T),class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed"},[t(p)?(a(),n("span",pe,e[14]||(e[14]=[s("svg",{class:"animate-spin h-5 w-5 text-purple-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):w("",!0),M(" "+c(t(p)?"Updating password...":"Update password"),1)],8,ue)])]))])],32)])])}}},xe=O(we,[["__scopeId","data-v-778baff8"]]);export{xe as default};
